import{g,a as $,s as R,t as d,d as D,b as x,i as p,c as S,M as P,e as U,f as L,j as Y,u as k,k as v,l as w,m as H,o as z}from"./web.7L2m69k-.js";const V={logoSplash:"/assets/img/evo_splash_04.png",cardLoader:"/assets/img/cardLoader.svg",loader:"/assets/img/loader.svg",noLoader:"/assets/img/noLoader.svg",typeless:"/assets/img/typeless.png",moreStatusEffects:"/assets/img/passive_quest_icon.png",moves:"/assets/img/moves.png",characters:"/assets/img/characters.png",meta:"/assets/img/meta/meta_tape_default.png",metaTapeBg:"/assets/img/meta/meta_tape_bg.png",metaTapeBootlegBg:"/assets/img/meta/meta_tape_bootleg_bg.png",metaTapeOverlay:"/assets/img/meta/meta_tape_overlay.png",metaAp:"/assets/img/meta/ap.png",metaApx:"/assets/img/meta/ap-x.png",characterBg:"/assets/img/meta/character_bg.png",tapeBg:"/assets/img/meta/tape.png",tapeBootlegBg:"/assets/img/meta/tape_bootleg.png",tapeOverlay:"/assets/img/meta/tape_overlay.png",unknown:"/assets/img/passive_quest_icon.png"};var j=d("<img class=noselect draggable=false alt=loading>");const C=e=>{let n=3;switch(e.size){case"xs":n=1;break;case"sm":n=2;break;case"md":n=3;break;case"lg":n=6;break;case"xl":n=12;break}const m=`${n*8}px`;return(()=>{var l=g(j);return m!=null?l.style.setProperty("width",m):l.style.removeProperty("width"),m!=null?l.style.setProperty("height",m):l.style.removeProperty("height"),$(()=>R(l,"src",V.loader)),l})()},F="en",G={remaster:"UI_EVOLUTION_TITLE",stickers:"UI_PARTY_STICKERS",maxHP:"SHORT_NAME_max_hp",mAtk:"SHORT_NAME_melee_attack",mDef:"SHORT_NAME_melee_defense",rAtk:"SHORT_NAME_ranged_attack",rDef:"SHORT_NAME_ranged_defense",speed:"SHORT_NAME_speed",elementalType:"UI_INVENTORY_FILTER_TYPE",name:"UI_INVENTORY_FILTER_NAME",category:"UI_INVENTORY_FILTER_CATEGORY",power:"MOVE_DESCRIPTION_POWER",accuracy:"STAT_accuracy",evasion:"STAT_evasion",maxAP:"STAT_max_ap",moveSlots:"STAT_move_slots",ap:"BATTLE_TOAST_AP",chance:"BATTLE_TOAST_RECORD_CHANCE",recording:"STATUS_RECORDING_NAME",chooseSpecialisation:"UI_EVOLUTION_SPECIALIZATION",expPoints:"STAT_exp",viewMonsters:"UI_BESTIARY_LIST_MODE_VIEW_MONSTERS",viewStickers:"UI_PARTY_VIEW_MOVES",elementalTypeChart:"ITEM_TYPE_CHART_NAME",statusEffect:"MOVE_CATEGORY_STATUS",language:"TITLE_SCREEN_LANGUAGE_BUTTON",other:"UI_QUEST_LOG_SECTION_OTHER",applySticker:"UI_PARTY_APPLY_STICKER",stats:"UI_BESTIARY_INFO_TAB_STATS",passive:"UI_BUTTON_MOVE_PASSIVE",priorityChance:"STAT_priority_chance",humanForm:"UI_PARTY_STATS_CHARACTER",habitat:"UI_BESTIARY_INFO_TAB_LOCATION",unlockedAbility:"ABILITY_UNLOCKED",dlcPierOfTheUnknown:"DLC_01_PIER_NAME",attacker:"TYPE_CHART_ATTACKER",defender:"TYPE_CHART_DEFENDER",transmutation:"TYPE_CHART_TRANSMUTATION",noReaction:"TYPE_CHART_NO_REACTION",buffs:"TYPE_CHART_BUFFS",debuffs:"TYPE_CHART_DEBUFFS",map:"UI_PAUSE_MAP_BTN",typeless:"UI_INVENTORY_FILTER_TYPE_TYPELESS",cassetteBeasts:"MAIN_CREDITS_TITLE",homePageLongText1:"TUTORIAL_REMASTER",homePageLongText2:"TUTORIAL_RUMORS_DESCRIPTION1",fusion:"ONLINE_REQUEST_UI_BATTLE_RULES_REL_LEVEL",sameFusion1:"SAME_FUSION_NAME_1",sameFusion2:"SAME_FUSION_NAME_2",sameFusion3:"SAME_FUSION_NAME_3",sameFusion4:"SAME_FUSION_NAME_4",sameFusion5:"SAME_FUSION_NAME_5",sameFusion6:"SAME_FUSION_NAME_6",sameFusion7:"SAME_FUSION_NAME_7",sameFusion8:"SAME_FUSION_NAME_8",sameFusion9:"SAME_FUSION_NAME_9",fusionDescription1:"TUTORIAL4_PART3C_KAYLEIGH2",fusionDescription2:"TUTORIAL_BOSS_1.m",fusionDescription3:"TUTORIAL_FUSION1.m"};var y=(e=>(e[e.pending=0]="pending",e[e.loading=1]="loading",e[e.success=2]="success",e[e.error=3]="error",e))(y||{});const b=e=>{if((e??"").indexOf("res://")<0)return e??"";const n=(e??"").replace("res://","");return n.length<1?"/assets/img/passive_quest_icon.png?orig="+e:`/assets/img/generated/${n}`};var K=d("<img loading=lazy>"),W=d("<p>"),q=d("<summary data-todo=translate>❌ Something went wrong"),Q=d("<summary>"),Z=d('<details class="monster dropdown"><!$><!/><ul>'),J=d("<summary data-todo=translate><!$><!/>Loading"),X=d('<div class="monster-option selected">'),ee=d('<li class="monster-option noselect">');const te=e=>{let n;const m=_=>[(()=>{var A=g(K);return $(f=>{var u=b(_.icon),h=_.name;return u!==f.e&&R(A,"src",f.e=u),h!==f.t&&R(A,"alt",f.t=h),f},{e:void 0,t:void 0}),A})(),(()=>{var A=g(W);return p(A,()=>_.name),A})()],l=_=>{n?.removeAttribute("open"),e.selectMonster(_)};return(()=>{var _=g(Z),A=_.firstChild,[f,u]=x(A.nextSibling),h=f.nextSibling,s=n;return typeof s=="function"?k(s,_):n=_,p(_,S(L,{get fallback(){return(()=>{var t=g(J),a=t.firstChild,[r,o]=x(a.nextSibling);return r.nextSibling,p(t,S(C,{size:"sm"}),r,o),t})()},get children(){return[S(P,{get when(){return e.networkState===y.error},get children(){return g(q)}}),S(P,{get when(){return e.networkState===y.success},get children(){var t=g(Q);return p(t,(()=>{var a=U(()=>e.selectedMonster!=null);return()=>a()?(()=>{var r=g(X);return p(r,()=>m(e.selectedMonster)),r})():e.translate[G.viewMonsters]})()),t}})]}}),f,u),p(h,()=>e.monsters.map(t=>(()=>{var a=g(ee);return a.$$click=()=>l(t),p(a,()=>m(t)),Y(),a})())),_})()};D(["click"]);var se=d('<h2 class="ta-center mt-1">');const ne=e=>{const[n,m]=v("");return w(()=>{if(e.monsterA==null&&e.monsterB==null){m("...");return}if(e.monsterA?.id==e.monsterB?.id){const l=(e.monsterA?.bestiary_index??0)%10,_=e.translate[`SAME_FUSION_NAME_${l+1}`];m(_.replace("{0}",e.monsterA?.name??""));return}m(`${e.monsterA?.prefix??"..."}${e.monsterB?.suffix??"..."}`)},[e.monsterA?.id,e.monsterB?.id]),(()=>{var l=g(se);return p(l,n),l})()},re=e=>Math.max(e.lastIndexOf("\\"),e.lastIndexOf("/")),ae=e=>{const n=re(e);return e.substring(n+1)};var ie=d("<img class=fusion-node>");const oe=e=>{const n=e.sizeMultiplier??3,m=e.fusion??{};if(m.visible==!1)return;const l=(s,t)=>{let a=s[t.name];if(a==null){const o=ae(t.instance_external_path??"").replace(".json","");a=s[o]}const r=a?.animations?.[0]?.frames?.[0];return{width:r?.width!=null?r.width*n+"px":"unset",height:r?.height!=null?r.height*n+"px":"unset"}},_=s=>s*n+"px",A=s=>{const t=s.instance_external_path??"",a=b(t.replace(".json",".png"));if((a?.length??0)!=0)return a},u=((s,t)=>{if(s==null)return;const a={...s};if((a?.parent?.length??0)!=0){const r=t[a.parent];if(r!=null){if(r.visible==!1)return;a.position.y=r.position.y,a.position.x=r.position.x}}return a})(m,e.fusionPartsList);if(u==null)return;const h=A(u);if(h!=null)return(()=>{var s=g(ie);return R(s,"src",h),$(t=>{var a=u.name,r=u.name,o=_(u.position.y),i=_(u.position.x),c=l(e.fusionSpriteMap,u).width,T=l(e.fusionSpriteMap,u).height,E=u.index??0;return a!==t.e&&R(s,"id",t.e=a),r!==t.t&&R(s,"alt",t.t=r),o!==t.a&&((t.a=o)!=null?s.style.setProperty("top",o):s.style.removeProperty("top")),i!==t.o&&((t.o=i)!=null?s.style.setProperty("left",i):s.style.removeProperty("left")),c!==t.i&&((t.i=c)!=null?s.style.setProperty("width",c):s.style.removeProperty("width")),T!==t.n&&((t.n=T)!=null?s.style.setProperty("height",T):s.style.removeProperty("height")),E!==t.s&&((t.s=E)!=null?s.style.setProperty("z-index",E):s.style.removeProperty("z-index")),t},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),s})()};var le=d("<div class=fusion-item>"),_e=d('<div class="fusion-container mb-1">');const me=e=>{const[n,m]=v(),[l,_]=v(),[A,f]=v(0),[u,h]=v(0),[s,t]=v(1);w(()=>{if(e.fusionSpriteMap==null||e.itemMap==null)return;const r=e.itemMap[e.monsterA?.id??""];r!=null&&m(r.nodes_enhanced);const o=e.itemMap[e.monsterB?.id??""];o!=null&&_(o.nodes_enhanced);let i=0,c=0;for(const M of Object.values(e.fusionSpriteMap??{})){const I=M.animations[0].frames[0];I.height>i&&(i=I.height),I.width>c&&(c=I.width)}let T=0;for(const M of Object.values(r?.nodes_enhanced??{}))M.position.y<T&&(T=M.position.y);const E=screen.availHeight/2.5/i,N=screen.availWidth/2.5/c,O=Math.min(E,N);f(i),t(O),h(Math.abs(T)*O)},[e.monsterA?.id,e.monsterB?.id,e.fusionSpriteMap,e.itemMap]);const a=(r,o)=>{let i=[];for(const c of Object.values(r??{}))i.push(c);return i};return[S(ne,{get translate(){return e.translate},get monsterA(){return e.monsterA},get monsterB(){return e.monsterB}}),(()=>{var r=g(_e);return p(r,S(H,{get when(){return U(()=>n()!=null)()&&l()!=null},get children(){var o=g(le);return p(o,()=>a(n(),l()).map(i=>S(oe,{fusion:i,get fusionSpriteMap(){return e.fusionSpriteMap},get fusionPartsList(){return n()??{}},get sizeMultiplier(){return s()}}))),$(i=>{var c=`${u()}px`,T=s()*A()+"px",E=s()*A()+"px";return c!==i.e&&((i.e=c)!=null?o.style.setProperty("margin-top",c):o.style.removeProperty("margin-top")),T!==i.t&&((i.t=T)!=null?o.style.setProperty("height",T):o.style.removeProperty("height")),E!==i.a&&((i.a=E)!=null?o.style.setProperty("width",E):o.style.removeProperty("width")),i},{e:void 0,t:void 0,a:void 0}),o}})),r})()]};var ue=d('<article class="mb-1 warning"><div class="card ta-center">⚠️ This is a work in progress'),ce=d("<summary data-todo=translate>❌ Something went wrong"),ge=d("<article class=mb-1><div class=fusion><div class=grid></div><!$><!/>"),de=d("<div class=fusion-container><div>");const Ae=e=>{const[n,m]=v(),[l,_]=v(),[A,f]=v({}),[u,h]=v({}),[s,t]=v([]),[a,r]=v(y.loading),o=async()=>{const i=fetch(`/${F}/data/fusion.json`),c=fetch(`/${F}/data/fusionSpriteAnim.json`),T=fetch(`/${e.locale}/data/monsterDropDown.json`);try{const[E,N,O]=await Promise.all([i,c,T]),[M,I,B]=await Promise.all([E.json(),N.json(),O.json()]);f(M),h(I),t(B)}catch(E){console.log(E),r(y.error)}r(y.success)};return z(()=>{o()}),[g(ue),(()=>{var i=g(ge),c=i.firstChild,T=c.firstChild,E=T.nextSibling,[N,O]=x(E.nextSibling);return p(T,S(te,{get networkState(){return a()},get translate(){return e.translate},get monsters(){return s()},get selectedMonster(){return n()},selectMonster:m})),p(c,S(L,{get fallback(){return(()=>{var M=g(de),I=M.firstChild;return I.style.setProperty("margin","5vh auto"),p(I,S(C,{size:"xl"})),M})()},get children(){return[S(P,{get when(){return a()===y.error},get children(){return g(ce)}}),S(P,{get when(){return a()===y.success},get children(){return S(me,{get translate(){return e.translate},get itemMap(){return A()},get fusionSpriteMap(){return u()},get monsterA(){return n()},get monsterB(){return l()}})}})]}}),N,O),i})()]};export{Ae as FusionPanel};
